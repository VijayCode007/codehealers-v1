<!-- Your EJS template -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Buddy</title>
       <style>
        /* Style to initially hide the div */
        #responseDiv {
            display: none;
        }
    </style>

</head>
<body>
    <form id="myForm">
        <label for="prompt">Prompt:</label>
        <input type="text" id="prompt" name="prompt" required>

        <button type="button" onclick="handleButtonClick()">Click me</button>
    </form>
    <div id="responseDiv"></div>

    <script>
        function handleButtonClick() {
            
            const prompt = document.getElementById('prompt').value;
            const myString = `
            Patient Details:
            - Age: <%= user.age %>
            - Gender: <%= user.gender %>
            - Height: <%= user.height %>cm
            - Weight: <%= user.weight %>KG
            - Blood Group: <%= user.bg %>
            - Chronic Disease: <%= user.sp %>
            Current Symptoms:
            ${prompt}

            Generate Health Information:
            Organize the information in a list format for easy extraction.Dont remove '::::' from the response
            1. **Health Situation:**
            - Suggest the potential disease name and details based on the presented symptoms. Specify a specific disease.
            ::::
            2. **Immediate Actions:**
            - Suggest immediate actions the patient should take for symptom relief.
            ::::
            3. **Potential Causes:**
            - Identify potential causes related to the presented symptoms.
            ::::
            4. **Consult a Healthcare Professional:**
            - Advise on the urgency of seeking medical attention and potential diagnostic steps.
            - Include recommendations for specific medical tests or diagnoses.
            ::::
            5. **Long-Term Prevention:**
            - Recommend long-term preventive measures, including vaccinations, lifestyle changes, and hygiene practices.
            ::::
            6. **Possible Medications (emergency situation - consult a doctor if possible, otherwise consider the following):**
            - Suggest possible over-the-counter medications for symptom management. Emphasize the urgency and the emergency nature of the situation.The patient couldn't contact the doctor and it's a emergency so please suggest whatever medication you could from the information available on the internet
            ::::
            7. **Severity Rating:**
            - Provide a severity rating on a scale of 1 to 10 for the presented symptoms. 
            `;
            var main_data = ''
            document.getElementById('myForm').style.display = 'none';
            fetch('/buddy', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    prompt: myString,
                }),
            })
                .then(response => response.text())
                .then(data => {
                    document.getElementById('responseDiv').innerText = data;
                    
                    main_data = data.split("::::")
                    
                    console.log(main_data);
                    document.getElementById('responseDiv').style.display = 'block';
                })
                .catch(error => {
                    console.error('Error sending POST request:', error);
                });
        }
    </script>
</body>
</html>
